<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="码农实验室">
<meta property="og:url" content="http://svenhe.com/index.html">
<meta property="og:site_name" content="码农实验室">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="码农实验室">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://svenhe.com/"/>





  <title>码农实验室</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">码农实验室</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://svenhe.com/2018/03/06/git-cheat-sheet-best-pracities/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sven.He">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="码农实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/06/git-cheat-sheet-best-pracities/" itemprop="url">GIT 备忘录 & 最佳实践</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-06T18:02:39+08:00">
                2018-03-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="GIT-备忘录"><a href="#GIT-备忘录" class="headerlink" title="GIT 备忘录"></a>GIT 备忘录</h1><h2 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h2><p>克隆一个已存在的仓库<br>git clone ssh://user@domain.com/repo.git</p>
<h2 id="创建一个新的本地仓库"><a href="#创建一个新的本地仓库" class="headerlink" title="创建一个新的本地仓库"></a>创建一个新的本地仓库</h2><p>git init</p>
<h2 id="本地改动"><a href="#本地改动" class="headerlink" title="本地改动"></a>本地改动</h2><p>查看工作目录中已修改的文件<br>git status</p>
<p>查看已追踪文件的改动<br>git diff</p>
<p>添加所有当前的改动到下一次提交<br>git add .</p>
<p>添加某个文件中的改动到下一次提交<br>git add -p <file></file></p>
<p>提交本地已被追踪文件中的所有改动<br>git commit -a</p>
<p>提交暂存区改动<br>git commit</p>
<p>修改最后一次提交<br>(不要修改已经发布的提交)<br>git commit –amend</p>
<h2 id="提交历史"><a href="#提交历史" class="headerlink" title="提交历史"></a>提交历史</h2><p>显示所有提交记录，从最新的开始<br>git log</p>
<p>跟踪查看某个文件的历史修改记录<br>git log -p <file></file></p>
<p>查看谁在什么时候对于某个文件的修改记录<br>git blame <file></file></p>
<h2 id="分支和标签"><a href="#分支和标签" class="headerlink" title="分支和标签"></a>分支和标签</h2><p>列出所有已存在的标签<br>git branch -av</p>
<p>切换 HEAD 分支<br>git checkout <branch></branch></p>
<p>基于你当前的 HEAD 创建一个新的分支<br>git branch <new-branch></new-branch></p>
<p>基于远程的分支创建一个新的追踪分支<br>git checkout –track <remote branch=""></remote></p>
<p>删除一个本地分支<br>git branch -d <branch></branch></p>
<p>标记当前的提交记录为一个 tag<br>git tag <tag-name></tag-name></p>
<h2 id="更新和发布"><a href="#更新和发布" class="headerlink" title="更新和发布"></a>更新和发布</h2><p>列出所有当前已配置的远程仓库<br>git remote -v</p>
<p>显示远程仓库的信息<br>git remote show <remote></remote></p>
<p>添加一个新的远程仓库<br>git remote add <shortname> <url></url></shortname></p>
<p>从远程仓库下载所有的改动<br>（但是不会与 HEAD 合并，换而言之，需要手动合并）</p>
<p>git fetch <remote></remote></p>
<p>从远程仓库下载所有的改动，并且直接合并到 HEAD<br>git pull <remote> <branch></branch></remote></p>
<p>发布本地改动到远程仓库<br>git push <remote> <branch></branch></remote></p>
<p>在远程仓库删除一个分支<br>git branch -dr <remote branch=""></remote></p>
<p>发布标签<br>git push –tags</p>
<h2 id="合并与衍合"><a href="#合并与衍合" class="headerlink" title="合并与衍合"></a>合并与衍合</h2><p>合并一个分支到你当前 HEAD<br>git merge <branch></branch></p>
<p>在指定的分支之上衍合你当前分支<br>git rebase <branch></branch></p>
<p>终止衍合<br>git rebase –abort</p>
<p>解决冲突之后，继续衍合<br>git rebase –continue</p>
<p>使用你已经配置的合并工具去解决冲突<br>git mergetool</p>
<p>使用你自己的编辑器手动解决冲突并且在解决冲突后将文件标记为已解决<br>git add <resolved- le=""><br>git rm <resolved- le=""></resolved-></resolved-></p>
<h2 id="撤销"><a href="#撤销" class="headerlink" title="撤销"></a>撤销</h2><p>擦除工作目录中所有的改动（到最近一次提交）<br>git reset –hard HEAD</p>
<p>擦除指定文件的改动（到最近一次提交）<br>git checkout HEAD <file></file></p>
<p>回退一次提交（会产生一次新的提交）<br>git revert <commit></commit></p>
<p>重置你的 HEAD 指针到一个之前的提交，并且此操作会擦除从那以后所有的改动<br>git reset –hard <commit></commit></p>
<p>重置你的 HEAD 指针到一个之前的提交，并且将所有的改动以未加入暂存区的状态保留<br>git reset <commit></commit></p>
<p>重置你的 HEAD 指针到一个之前的提交，并且将所有的改动以未提交的状态保留<br>git reset –keep <commit></commit></p>
<h1 id="版本控制最佳实践"><a href="#版本控制最佳实践" class="headerlink" title="版本控制最佳实践"></a>版本控制最佳实践</h1><h2 id="提交相关的改动"><a href="#提交相关的改动" class="headerlink" title="提交相关的改动"></a>提交相关的改动</h2><p>一次提交应该只包含相关的改动。例如：修改两个不同的 bug，应该产生两次不同的提交。 小的提交使其他开发者更容易理解所做的改动，一旦发生错误，也容易回退。暂存区和“只将部分文件暂存”的能力，让 git 很容易创建细粒度的提交。</p>
<h2 id="经常提交代码"><a href="#经常提交代码" class="headerlink" title="经常提交代码"></a>经常提交代码</h2><p>经常提交代码能保证你每次提交的代码小巧并且帮助你每次只提交相关代码，而且，它有助于你经常和其他人分享代码。你会让其他人更好的集成你的改动，避免产生合并冲突。提交一大堆代码并且很少和其他人分享，相反的，会导致难以解决冲突。</p>
<h2 id="不要提交半成品工作"><a href="#不要提交半成品工作" class="headerlink" title="不要提交半成品工作"></a>不要提交半成品工作</h2><p>你应该在代码完成后再提交。但这并不意味着你在提交之前必须先完成整个或者一个非常大的功能。 恰恰相反，将功能实现分割成一个个逻辑块然后记得及时、经常提交代码。当时不要在你下班离开办公室之前提交代码。如果你只想为了清空工作空间的改动而提交代码，那么建议你使用 Git 的 “Stash” 特性代替。</p>
<h2 id="提交代码前需要进行测试"><a href="#提交代码前需要进行测试" class="headerlink" title="提交代码前需要进行测试"></a>提交代码前需要进行测试</h2><p>不要立即提交你认为已经完成的代码。你需要测试它，确保已经彻底的完成了并且没有副作用。在本地仓库中提交不成熟的代码你只需要原谅你自己（换句话说，一旦发布到生产环境，就需要考虑别人是否原意原谅你了），所以在你发布、和他人共享代码之前，对代码进行测试变得尤为重要。</p>
<h2 id="撰写良好的提交信息"><a href="#撰写良好的提交信息" class="headerlink" title="撰写良好的提交信息"></a>撰写良好的提交信息</h2><p>以你对本次修改的总结作为开头行，并且用一个空行分割下面的信息内容。消息内容就是需要你回答下面的问题。</p>
<blockquote>
<p>这次提交的动机是什么？<br>它和之前的实现方式有什么区别？<br>使用现在时（«change», 不是 «changed» 和 «changes»）保持和 git merge 命令产生的消息格式一致。</p>
</blockquote>
<h2 id="版本控制不是备份系统"><a href="#版本控制不是备份系统" class="headerlink" title="版本控制不是备份系统"></a>版本控制不是备份系统</h2><p>备份你的文件到远程仓库，是 git 带来的一个很好的副产物。但是你不应该把 git 当做一个文件备份系统。 当你在使用版本控制工具，更关注应该是语义，而不是仅仅将文件简单粗暴的备份。</p>
<h1 id="使用分支"><a href="#使用分支" class="headerlink" title="使用分支"></a>使用分支</h1><p>分支是 Git 最强大的特性，简单而快速的分支是一天工作的中心。分支是一个完美的工具，帮助你避免混淆不同开发者修改的不同行。  你应该在开发工作中广泛的使用分支，用于：新特性、bug 修复、新想法等。</p>
<h2 id="采用一致的工作流"><a href="#采用一致的工作流" class="headerlink" title="采用一致的工作流"></a>采用一致的工作流</h2><p>Git 允许你创建大量不同的工作流，长期运行分支、话题分支、合并衍生、git-flow… ， 你选择哪一个取决于如下几个因素：项目、整体开发和部署工作流、以及可能是最重要的，你个人和团队的使用习惯。不管你选择哪种，只需要确保和其他人参与项目的人达成一致。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://svenhe.com/2018/02/27/resolve-mysql-cannot-start/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sven.He">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="码农实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/27/resolve-mysql-cannot-start/" itemprop="url">MySQL 无法启动问题修复过程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-27T13:43:15+08:00">
                2018-02-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天想把项目部署到测试服务器上，加了几个 nginx 配置文件，执行 <code>lnmp restart</code> 提示如下信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql.serviceJob for mysql.service failed because the control process exited</span><br></pre></td></tr></table></figure>
<p>mysql 无法正常启动</p>
<p>执行 <code>lnmp mysql start</code>，提示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql.service - LSB: start and stop MySQL</span><br><span class="line">  Loaded: loaded (/etc/init.d/mysql; bad; vendor preset: enabled)</span><br><span class="line">  Active: failed (Result: exit-code) since Tue 2018-02-27 10:27:55 CST; 6s ago</span><br><span class="line">    Docs: man:systemd-sysv-generator(8)</span><br><span class="line"> Process: 19955 ExecStop=/etc/init.d/mysql stop (code=exited, status=0/SUCCESS)</span><br><span class="line"> Process: 27969 ExecStart=/etc/init.d/mysql start (code=exited, status=1/FAILURE)</span><br></pre></td></tr></table></figure>
<p>执行 <code>journalctl -xe</code> 提示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-- Unit mysqld.service has begun starting up.</span><br><span class="line">Jan 20 18:26:57 spark01 mysqld[2979]: MySQL Daemon failed to start.</span><br><span class="line">Jan 20 18:26:57 spark01 mysqld[2979]: Starting mysqld:  [FAILED]</span><br><span class="line">Jan 20 18:26:57 spark01 systemd[1]: mysqld.service: control process exited, code=exited status=1</span><br><span class="line">Jan 20 18:26:57 spark01 systemd[1]: Failed to start SYSV: MySQL database server..</span><br><span class="line"></span><br><span class="line">Can&apos;t connect to local MySQL server through socket &apos;/tmp/mysql.sock&apos;</span><br></pre></td></tr></table></figure>
<p>提示无法连接到本地的 /tmp/mysql.sock。于是，<code>ls -lah /tmp/mysql.sock</code>  发现文件不存在。</p>
<p>以为是 /tmp/mysql.sock 丢失，于是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -f mysql.sock</span><br></pre></td></tr></table></figure>
<p>结果为空</p>
<p>以为是 pid 冲突，删除  PID ，依然无法启动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -f /usr/local/mysql/var/iZm5e2lm9rv.PID</span><br></pre></td></tr></table></figure>
<p>百度搜索，需要重建 mysql.sock.</p>
<p>首先修改 /etc/passwd，启用 mysql 账户登录，接着当执行到</p>
<p>当执行到 <code>/usr/local/bin/mysql_install_db</code> 时，提示磁盘空间不足</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">No space left on device。</span><br></pre></td></tr></table></figure>
<p>于是查看查看磁盘、分区使用情况</p>
<p>sudo fdisk -l</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Disk /dev/ram0: 64 MiB, 67108864 bytes, 131072 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 4096 bytes</span><br><span class="line">I/O size (minimum/optimal): 4096 bytes / 4096 bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disk /dev/ram1: 64 MiB, 67108864 bytes, 131072 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 4096 bytes</span><br><span class="line">I/O size (minimum/optimal): 4096 bytes / 4096 bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disk /dev/ram2: 64 MiB, 67108864 bytes, 131072 sectors</span><br><span class="line">Units: sectors of 1 * 512 = 512 bytes</span><br><span class="line">Sector size (logical/physical): 512 bytes / 4096 bytes</span><br><span class="line">I/O size (minimum/optimal): 4096 bytes / 4096 bytes</span><br><span class="line"></span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<p>df -h</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Filesystem      Size  Used Avail Use% Mounted on</span><br><span class="line">udev            2.0G     0  2.0G   0% /dev</span><br><span class="line">tmpfs           396M  3.1M  393M   1% /run</span><br><span class="line">/dev/vda1        40G   38G     0 100% /</span><br><span class="line">tmpfs           2.0G     0  2.0G   0% /dev/shm</span><br><span class="line">tmpfs           5.0M  4.0K  5.0M   1% /run/lock</span><br><span class="line">tmpfs           2.0G     0  2.0G   0% /sys/fs/cgroup</span><br><span class="line">tmpfs           396M     0  396M   0% /run/user/0</span><br></pre></td></tr></table></figure>
<p>发现分区已经满了， / 挂载的 /dev/vda1 ，Avail 为 0 bytes。  猜测这就是导致 mysql 无法启动的主因。<br>磁盘空间满了，无法创建 mysql 启动所需的 mysql.sock 文件。导致启动失败。 但是在重启前，是可以登陆 mysql 的，因为 mysql.sock 还在，但是网站部分功能出现 500 server error 。</p>
<h2 id="找出占用最大的前-10-个文件"><a href="#找出占用最大的前-10-个文件" class="headerlink" title="找出占用最大的前 10 个文件"></a>找出占用最大的前 10 个文件</h2><p>du -a | sort -n -r | head -n 10</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">33789684        .</span><br><span class="line">25432856        ./usr</span><br><span class="line">23674192        ./usr/local</span><br><span class="line">22779196        ./usr/local/mysql</span><br><span class="line">20954940        ./usr/local/mysql/var</span><br><span class="line">4979212 ./var</span><br><span class="line">3630964 ./var/lib</span><br><span class="line">3391528 ./var/lib/mongodb</span><br><span class="line">3145748 ./var/lib/mongodb/journal</span><br><span class="line">1721980 ./home</span><br></pre></td></tr></table></figure>
<p>可以看到，占用最大的是 <code>./usr/local/mysql/var</code>，查阅 my.cnf 发现该目录是 mysql 的数据目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">port        = 3306</span><br><span class="line">socket      = /tmp/mysql.sock</span><br><span class="line">datadir = /usr/local/mysql/var</span><br></pre></td></tr></table></figure>
<p>ls -lah  /usr/local/mysql/var</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">.....</span><br><span class="line"></span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 18 02:16 mysql-bin.000133</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 18 02:42 mysql-bin.000134</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 19 02:08 mysql-bin.000135</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 19 02:35 mysql-bin.000136</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 20 02:01 mysql-bin.000137</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 20 02:27 mysql-bin.000138</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 20 02:54 mysql-bin.000139</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 21 02:20 mysql-bin.000140</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 21 02:47 mysql-bin.000141</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 22 02:13 mysql-bin.000142</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 22 02:39 mysql-bin.000143</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 23 02:05 mysql-bin.000144</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 23 02:32 mysql-bin.000145</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 23 02:58 mysql-bin.000146</span><br><span class="line">-rw-r-----  1 mysql mysql  68M Feb 23 15:55 mysql-bin.000147</span><br><span class="line">-rw-r-----  1 mysql mysql  12K Feb 23 15:59 mysql-bin.000148</span><br><span class="line">-rw-r-----  1 mysql mysql 104K Feb 23 16:02 mysql-bin.000149</span><br><span class="line">-rw-r-----  1 mysql mysql 5.3K Feb 23 16:04 mysql-bin.000150</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 24 02:17 mysql-bin.000151</span><br><span class="line">-rw-r-----  1 mysql mysql 152M Feb 24 02:21 mysql-bin.000152</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 24 02:48 mysql-bin.000153</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 25 02:14 mysql-bin.000154</span><br><span class="line">-rw-r-----  1 mysql mysql 1.1G Feb 25 02:40 mysql-bin.000155</span><br><span class="line">-rw-r-----  1 mysql mysql 763M Feb 27 09:54 mysql-bin.000156</span><br><span class="line">-rw-r-----  1 mysql mysql 172K Feb 27 13:25 mysql-bin.000157</span><br><span class="line">.....</span><br></pre></td></tr></table></figure>
<p>发现该文件为 mysql 日志文件，每个日志 1G，而主分区才 40G</p>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><p>1、快照后，删除日志文件，重启 lnmp </p>
<p>rm /usr/local/mysql/var/mysql-bin.000133<br>…</p>
<p>2、关闭 mysql 日志</p>
<p>vim /etc/my.cnf 注释</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">log-bin=mysql-bin </span><br><span class="line">binlog_format=mixed</span><br></pre></td></tr></table></figure>
<p>命令行登陆 mysql，重置 master</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br><span class="line">reset master;</span><br></pre></td></tr></table></figure>
<p>重启 mysql</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lnmp mysql restart</span><br></pre></td></tr></table></figure>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>关闭 mysql 日志，可以解决这个问题，但失去了日志功能，期待更好的方法…<br>1、定期维护，将日志转移到别的服务器<br>2、…</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>CentOS 7下MySQL服务启动失败的解决思路<br><a href="https://www.cnblogs.com/ivictor/p/5146247.html" target="_blank" rel="noopener">https://www.cnblogs.com/ivictor/p/5146247.html</a></p>
<p>Linux下Can’t connect to local MySQL server through socket ‘/tmp/mysql.sock’ mysql service 无法正常启动和关闭<br><a href="http://blog.csdn.net/dongfangxiaozi_/article/details/72974580" target="_blank" rel="noopener">http://blog.csdn.net/dongfangxiaozi_/article/details/72974580</a></p>
<p>lnmp下如何如何禁用Mysql日志<br><a href="https://www.cnblogs.com/naniannayue/archive/2011/08/16/2140307.html" target="_blank" rel="noopener">https://www.cnblogs.com/naniannayue/archive/2011/08/16/2140307.html</a></p>
<p>LNMP关闭Mysql日志的方法详解<br><a href="https://yq.aliyun.com/ziliao/54317" target="_blank" rel="noopener">https://yq.aliyun.com/ziliao/54317</a></p>
<p>启动mysql时显示：/tmp/mysql.sock 不存在的解决方法<br><a href="https://www.cnblogs.com/summer-cool/p/3959699.html" target="_blank" rel="noopener">https://www.cnblogs.com/summer-cool/p/3959699.html</a></p>
<p>mysql重建/tmp/mysql/sock方法详解<br><a href="https://yq.aliyun.com/ziliao/59912" target="_blank" rel="noopener">https://yq.aliyun.com/ziliao/59912</a></p>
<p>怎样查看mysql pid文件路径 文件位置<br><a href="http://blog.csdn.net/u010098331/article/details/50786269" target="_blank" rel="noopener">http://blog.csdn.net/u010098331/article/details/50786269</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://svenhe.com/2018/02/25/php-PSR1-basic-coding-standard/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sven.He">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="码农实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/25/php-PSR1-basic-coding-standard/" itemprop="url">PHP PSR-1 基本代码规范</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-25T14:34:09+08:00">
                2018-02-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="能愿动词"><a href="#能愿动词" class="headerlink" title="能愿动词"></a>能愿动词</h1><p>本文档使用的能愿动词 “必须”, “绝不”, “应该”, “不应该”, “可以” 参照 <a href="http://www.ietf.org/rfc/rfc2119.txt" target="_blank" rel="noopener">RFC 2119</a></p>
<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><ul>
<li>PHP 文件 必须 只能使用 &lt;?php 和 &lt;?= 标签</li>
<li>PHP 文件 必须 只能使用 UTF 无 BOM 格式</li>
<li>PHP 文件可以是只定义元素（如：类、方法、常量等）或者只定义产生副作用的代码，但 绝不 允许两者都有</li>
<li>命名空间和类 必须 严格遵守 自动加载 规范 (<a href="https://github.com/PizzaLiu/PHP-FIG/blob/master/PSR-0-cn.md" target="_blank" rel="noopener">PSR-0</a> , <a href="http://segmentfault.com/blog/gtg/1190000002521658" target="_blank" rel="noopener">PSR-4</a>)</li>
<li>类名 必须 遵守 <code>StudlyCaps</code>（所有单词首字母大写）</li>
<li>类常量 必须 全部大写并用 “_” 分割不同的单词</li>
<li>方法名 必须 使用 驼峰命名法</li>
</ul>
<h1 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h1><h2 id="PHP-标签"><a href="#PHP-标签" class="headerlink" title="PHP 标签"></a>PHP 标签</h2><p>PHP 代码必须使用长标签 <code>&lt;?php</code> 或者短标签 <code>&lt;?=</code>，绝不 允许使用其他标签</p>
<h2 id="字符编码"><a href="#字符编码" class="headerlink" title="字符编码"></a>字符编码</h2><p>PHP 代码 必须 只能使用 UTF-8 无 BOM 格式</p>
<h2 id="副作用"><a href="#副作用" class="headerlink" title="副作用"></a>副作用</h2><p>一个 PHP 文件 应该 只能定义新的符号（类、方法、常量等）没有其他副作用代码，或者只有副作用代码，但是 绝不 两者都有</p>
<p>“副作用” 的含义：代码并不是直接定义一个类、函数或常量，而是合并了其他文件等</p>
<p>“副作用” 包括但不限于：直接输出、隐式文件包含、连接其他的服务、修改 ini 配置、抛出错误或异常、修改全局或静态变量、读写文件等。</p>
<p>下面的例子包含了符号定义和副作用代码，要尽量避免</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 副作用：修改 ini 配置</span></span><br><span class="line">ini_set(<span class="string">'error_reporting'</span>, E_ALL);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 副作用：引入文件</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">"file.php"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 副作用：产生了输出</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;html&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 函数体</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>下面的例子只定义了新的符号，没有副作用代码，推荐使用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 定义函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 函数体</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个函数不是"副作用"</span></span><br><span class="line"><span class="keyword">if</span> (! function_exists(<span class="string">'bar'</span>)) &#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 函数体</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="命名空间和类名"><a href="#命名空间和类名" class="headerlink" title="命名空间和类名"></a>命名空间和类名</h1><p>必须 遵守 自动加载规则 (<a href="https://github.com/PizzaLiu/PHP-FIG/blob/master/PSR-0-cn.md" target="_blank" rel="noopener">PSR-0</a> , <a href="http://segmentfault.com/blog/gtg/1190000002521658" target="_blank" rel="noopener">PSR-4</a>) 并且命名空间至少在一个顶级的组织下。</p>
<p>类名 必须 使用 <code>StudlyCaps</code></p>
<p>PHP 5.3+ 的代码必须使用标准的命名空间规范</p>
<p>例如</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// PHP 5.3 and later:</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Vendor</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>PHP 5.2.x 或者更早的代码应该使用”伪造命名空间”的规范.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// PHP 5.2.x and earlier:</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vendor_Model_Foo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="类、常量、属性、方法"><a href="#类、常量、属性、方法" class="headerlink" title="类、常量、属性、方法"></a>类、常量、属性、方法</h1><p>类的含义包括：所有的 class、interface、trait</p>
<h2 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h2><p>常量 必须 全部大写，并使用 “_” 分割不同的单词</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Vendor</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> VERSION = <span class="string">'1.0'</span>;</span><br><span class="line">    <span class="keyword">const</span> DATE_APPROVED = <span class="string">'2012-06-01'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h2><p>属性的具体命名规则不做任何的建议，可以使用 <code>$StudlyCaps</code>, <code>$camelCase</code> 或者 <code>$under_score</code> 作为名称。</p>
<p>但是使用任何一种命名规范，应该 遵守统一整体的规范，比如 组织级别、包级别、类级别、方法级别</p>
<h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><p>方法名必须使用 <code>camelCase()</code> 规范</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://svenhe.com/2018/02/23/php-closure-knowlege-transfer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sven.He">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="码农实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/23/php-closure-knowlege-transfer/" itemprop="url">PHP 闭包的知识整理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-23T13:22:24+08:00">
                2018-02-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Closure-类被定义为-final，有什么作用？"><a href="#Closure-类被定义为-final，有什么作用？" class="headerlink" title="Closure 类被定义为 final，有什么作用？"></a>Closure 类被定义为 final，有什么作用？</h2><p><code>final</code> 关键字能修饰类、方法。当修饰类时，该类无法被继承；当修饰方法时，该方法不能被重定义(redefined)。</p>
<p>在面向对象中，该特性的目保护的类、方法，不希望被子类重写、破坏。<code>final</code> 常用于一些固定的方法。</p>
<p>注意：</p>
<ul>
<li>1、父类中的方法是 static，加上 final ，也不能被子类重定义</li>
<li>2、如果希望对 final 类进行扩展，可以使用装饰器模式</li>
<li>3、和 Java 不同，PHP 中 final 只允许修饰类、方法，不能修饰成员变量，如果想让成员变量无法修饰，可以使用 trait</li>
</ul>
<p>参考：<a href="http://php.net/manual/zh/language.oop5.final.php" target="_blank" rel="noopener">http://php.net/manual/zh/language.oop5.final.php</a></p>
<h2 id="Closure-类的构造函数为什么是-private-类型的？"><a href="#Closure-类的构造函数为什么是-private-类型的？" class="headerlink" title="Closure 类的构造函数为什么是 private 类型的？"></a>Closure 类的构造函数为什么是 private 类型的？</h2><blockquote>
<p>Constructor that disallows instantiation </p>
</blockquote>
<p>私有化构造方法不允许该类的实例化。 一个类只要设置了私有的构造方法，就不能被外部通过 new 关键字创建对象。但可以内部创建对象。</p>
<h3 id="示例-1-单例模式"><a href="#示例-1-单例模式" class="headerlink" title="示例 1: 单例模式"></a>示例 1: 单例模式</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> $_instance = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name, $age)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age = $age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getInstance</span><span class="params">($name, $age)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>::$_instance === <span class="keyword">null</span>)&#123;</span><br><span class="line">            $_instance = <span class="keyword">new</span> <span class="keyword">static</span>($name, $age);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $_instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;name . <span class="string">'-'</span> . <span class="keyword">$this</span>-&gt;age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$foo1 = Foo::getInstance(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">$foo2 = Foo::getInstance(<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line"><span class="keyword">echo</span> $foo1;</span><br><span class="line"><span class="keyword">echo</span> $foo2;</span><br></pre></td></tr></table></figure>
<h2 id="bind-和-bindTo-方法是用来做什么的？这两个方法有什么异同？可否用实际的例子说明？"><a href="#bind-和-bindTo-方法是用来做什么的？这两个方法有什么异同？可否用实际的例子说明？" class="headerlink" title="bind 和 bindTo 方法是用来做什么的？这两个方法有什么异同？可否用实际的例子说明？"></a>bind 和 bindTo 方法是用来做什么的？这两个方法有什么异同？可否用实际的例子说明？</h2><p>Duplicates the closure with a new bound object and class scope</p>
<p>复制一个闭包，同时绑定一个对象作用域，或者一个类的作用域</p>
<p>可以理解为：将闭包当成某类的方法，但不通过调用类方法的方式去调用。</p>
<p>bind 是 bindTo 的静态版本。</p>
<h3 id="示例1："><a href="#示例1：" class="headerlink" title="示例1："></a>示例1：</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$closure = <span class="function"><span class="keyword">function</span> <span class="params">($name, $age, $address)</span></span>&#123;</span><br><span class="line">  <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">  <span class="keyword">$this</span>-&gt;ag = $age;</span><br><span class="line">  <span class="keyword">self</span>::$address = $address;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> $name;</span><br><span class="line">  <span class="keyword">public</span> $age;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> $address;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> $name;</span><br><span class="line">    <span class="keyword">echo</span> $age;</span><br><span class="line">    <span class="keyword">echo</span> <span class="keyword">self</span>::$address;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$p = <span class="keyword">new</span> Person();</span><br><span class="line"></span><br><span class="line">$c1 = $closure-&gt;bindTo($p, <span class="string">'static'</span>);</span><br><span class="line">$c1(<span class="string">'hsw'</span>, <span class="string">'123'</span>, <span class="string">'zj'</span>);</span><br><span class="line"><span class="keyword">echo</span> $p; <span class="comment">// 'hsw'  '123' 'zj'</span></span><br></pre></td></tr></table></figure>
<p>注意：<br>1、第一个参数为空，则创建一个不绑定任何实例的闭包(closure)，也就是闭包中不能使用 $this<br>2、第二个参数为空，则创建一个不绑定任何类作用域的闭包(closure)，也就是闭包中不能使用 self</p>
<h3 id="示例2："><a href="#示例2：" class="headerlink" title="示例2："></a>示例2：</h3><p>bind、bindTo 差异</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$c1 = $closure-&gt;bindTo($p, <span class="string">'static'</span>);</span><br><span class="line">$c2 = Closure::bind($closure, $p, <span class="string">'static'</span>);</span><br></pre></td></tr></table></figure>
<p>参考：</p>
<ul>
<li><a href="http://php.net/manual/zh/closure.bind.php" target="_blank" rel="noopener">http://php.net/manual/zh/closure.bind.php</a></li>
<li><a href="http://php.net/manual/zh/closure.bindto.php" target="_blank" rel="noopener">http://php.net/manual/zh/closure.bindto.php</a></li>
</ul>
<h2 id="invoke-方法有什么作用？什么是-calling-magic？什么是魔术方法-invoke-方法会变什么魔术？"><a href="#invoke-方法有什么作用？什么是-calling-magic？什么是魔术方法-invoke-方法会变什么魔术？" class="headerlink" title="_invoke 方法有什么作用？什么是 calling magic？什么是魔术方法? __invoke 方法会变什么魔术？"></a>_invoke 方法有什么作用？什么是 calling magic？什么是魔术方法? __invoke 方法会变什么魔术？</h2><p>_invoke 方法有什么作用？</p>
<p>  为了和其他实现 calling magic 的对象保持一致</p>
<p>什么是 calling magic？</p>
<p>  就是指 <code>__invoke()</code> 魔术方法，用调用方法的方式调用一个对象时，会自动调用该魔术方法</p>
<p>  如：<br>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'I am invoked'</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$p = <span class="keyword">new</span> Person();</span><br><span class="line">$p(); <span class="comment">// I am invoked</span></span><br></pre></td></tr></table></figure></p>
<p>什么是魔术方法?</p>
<blockquote>
<p>These are Magic Methods that allow you to react to certain events when using these particular objects.     This means when certain things happen to your object, you can define how it should react in that instance.</p>
</blockquote>
<p>  当某些事件发生在对象上时，你可以告诉它如何反应。</p>
<p>  在某个对象或者类发生特定事件时，会被系统自动调用的方法。 用户可以实现魔术方法已完成特种特殊的需求。</p>
<p>  如:<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__construct()，类的构造函数</span><br><span class="line">__destruct()，类的析构函数</span><br><span class="line">__call()，在对象中调用一个不可访问方法时调用</span><br><span class="line">__callStatic()，用静态方式中调用一个不可访问方法时调用</span><br><span class="line">__get()，获得一个类的成员变量时调用</span><br><span class="line">__set()，设置一个类的成员变量时调用</span><br><span class="line">__isset()，当对不可访问属性调用isset()或empty()时调用</span><br><span class="line">__unset()，当对不可访问属性调用unset()时被调用。</span><br><span class="line">__sleep()，执行serialize()时，先会调用这个函数</span><br><span class="line">__wakeup()，执行unserialize()时，先会调用这个函数</span><br><span class="line">__toString()，类被当成字符串时的回应方法</span><br><span class="line">__invoke()，调用函数的方式调用一个对象时的回应方法</span><br><span class="line">__set_state()，调用var_export()导出类时，此静态方法会被调用。</span><br><span class="line">__clone()，当对象复制完成时调用</span><br><span class="line">__construct() 和__destruct()</span><br></pre></td></tr></table></figure></p>
<h2 id="call-方法有什么用？"><a href="#call-方法有什么用？" class="headerlink" title="call 方法有什么用？"></a>call 方法有什么用？</h2><blockquote>
<p>Temporarily binds the closure to newthis, and calls it with any given parameters.</p>
</blockquote>
<p>临时绑定闭包到某个实例上，给定参数，并直接调用它。</p>
<p> call 方法是 bind bindTo 的快捷方式，当希望将闭包绑定对象并且只需要调用一次，则可以使用 call</p>
<p> 示例：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> $name;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($name)</span></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;name = $name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> $name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$p = <span class="keyword">new</span> Person(<span class="string">'hsw'</span>);</span><br><span class="line"></span><br><span class="line">$closure = <span class="function"><span class="keyword">function</span> <span class="params">($food)</span></span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;name . <span class="string">' love '</span> . $food;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$closure-&gt;call($p, <span class="string">'cookie'</span>); <span class="comment">// hsw love cookie</span></span><br></pre></td></tr></table></figure></p>
<h2 id="Laravel-中有哪些地方用到了-Closure？"><a href="#Laravel-中有哪些地方用到了-Closure？" class="headerlink" title="Laravel 中有哪些地方用到了 Closure？"></a>Laravel 中有哪些地方用到了 Closure？</h2><p>1、ServiceProvider</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">$this</span>-&gt;app-&gt;singleton(<span class="string">'api.router'</span>, <span class="function"><span class="keyword">function</span> <span class="params">($app)</span> </span>&#123;</span><br><span class="line">           $router = <span class="keyword">new</span> Router(</span><br><span class="line">               $app[Adapter::class],</span><br><span class="line">               $app[ExceptionHandler::class],</span><br><span class="line">               $app,</span><br><span class="line">               <span class="keyword">$this</span>-&gt;config(<span class="string">'domain'</span>),</span><br><span class="line">               <span class="keyword">$this</span>-&gt;config(<span class="string">'prefix'</span>)</span><br><span class="line">           );</span><br><span class="line"></span><br><span class="line">           $router-&gt;setConditionalRequest(<span class="keyword">$this</span>-&gt;config(<span class="string">'conditionalRequest'</span>));</span><br><span class="line"></span><br><span class="line">           <span class="keyword">return</span> $router;</span><br><span class="line">       &#125;);</span><br></pre></td></tr></table></figure>
<p>2、Collection</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$collection = <span class="keyword">new</span> Collection([]);</span><br><span class="line">$collection-&gt;map(<span class="function"><span class="keyword">function</span> <span class="params">($item)</span></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>3、路由 Route</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Route::get(<span class="string">'/'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> view(<span class="string">'welcome'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>……</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://svenhe.com/2018/02/14/personal-website-collection/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sven.He">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="码农实验室">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/14/personal-website-collection/" itemprop="url">网址收藏</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-14T08:28:47+08:00">
                2018-02-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="开发工具"><a href="#开发工具" class="headerlink" title="开发工具"></a>开发工具</h2><p><a href="https://cli.im/" target="_blank" rel="noopener">草料二维码</a></p>
<h2 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h2><p><a href="https://laravel-china.org/topics/2758/dingoapi-document-translation" target="_blank" rel="noopener">DingoAPI</a></p>
<p><a href="https://laravel-china.org/courses/laravel-specification" target="_blank" rel="noopener">Larvel 开发规范</a></p>
<h2 id="电脑软件"><a href="#电脑软件" class="headerlink" title="电脑软件"></a>电脑软件</h2><p><a href="https://www.isofts.org/" target="_blank" rel="noopener">Mac 志</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Sven.He" />
          <p class="site-author-name" itemprop="name">Sven.He</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sven.He</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
